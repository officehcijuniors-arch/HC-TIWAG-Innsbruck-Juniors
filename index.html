<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <title>HC TIWAG Innsbruck Juniors - Infosäule (Bereinigt)</title>

  <!-- ============================
       CSS – Schrift, Layout, Farben
       ============================ -->
  <style>
    @font-face {
      font-family: "Areno Serif";
      src: url("fonts/areno-serif-webfont.woff2") format("woff2"),
           url("fonts/areno-serif-webfont.woff") format("woff"),
           url("fonts/Areno-Serif.otf") format("opentype");
      font-weight: normal;
      font-style: normal;
      font-display: swap;
    }
    @font-face {
      font-family: "Areno Serif";
      src: url("fonts/areno-serif-webfont.woff2") format("woff2"),
           url("fonts/areno-serif-webfont.woff") format("woff"),
           url("fonts/Areno-Serif.otf") format("opentype");
      font-weight: 800;
      font-style: normal;
      font-display: swap;
    }

    html, body {
      margin: 0;
      height: 100%;
      background: #000;
      color: #fff;
      font-family: "Areno Serif", serif;
      overflow: hidden;
    }

    .page {
      position: absolute;
      inset: 0;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.8s ease;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .page.active {
      opacity: 1;
      pointer-events: all;
      z-index: 1;
    }

    iframe, video {
      width: 100%;
      height: 100%;
      border: 0;
      border-radius: 10px;
      display: block;
    }
    .video-page video {
      object-fit: contain;
    }

    .signature {
      position: fixed;
      bottom: 8px;
      right: 12px;
      font-size: 0.9em;
      color: rgba(255,255,255,0.4);
      pointer-events: none;
      z-index: 9999;
    }

    /* ============================
       Seite 8 – Glasrahmen mit animiertem Hintergrund
       ============================ */
    .frame-page {
        display: flex;
        align-items: center;
        justify-content: center;
        background: linear-gradient(135deg, #003789 50%, #d42323 50%);
        background-size: 200% 200%;
        animation: gradientShift 120s ease-in-out infinite;
    }

    @keyframes gradientShift {
        0%   { background-position: 0% 50%; }
        50%  { background-position: 100% 50%; }
        100% { background-position: 0% 50%; }
    }

    .frame-container {
        display: flex;
        align-items: center;
        justify-content: center;
        width: 100%;
        height: 100%;
    }

    .frame {
        border-radius: 20px;
        overflow: hidden;
        background: rgba(255,255,255,0.15);
        backdrop-filter: blur(12px);
        box-shadow: 0 20px 45px rgba(0,0,0,0.55);
        width: 90vw;
        height: 90vh;
        display: flex;
        align-items: center;
        justify-content: center;
        flex-direction: column;
        gap: 10px;
    }

    .frame.multiple iframe {
        height: 50%;
    }
  </style>
</head>
<body>

  <!-- =========================
       Seitenstruktur
       ============================ -->
  <section class="page page-1 active"><iframe data-src="Infopoint.html" title="Infosäule"></iframe></section>
  <section class="page page-2"><iframe data-src="KALENDER.html" title="Kalender"></iframe></section>
  <section class="page page-3"><iframe data-src="ORG.html" title="Organigramm"></iframe></section>
  <section class="page video-page page-4">
    <video autoplay loop muted playsinline preload="auto"><source src="Fotoshop.mp4" type="video/mp4"></video>
  </section>
  <section class="page video-page page-5">
    <video autoplay loop muted playsinline preload="auto"><source src="Fanshop.mp4" type="video/mp4"></video>
  </section>
  <section class="page video-page page-6">
    <video autoplay loop muted playsinline preload="auto"><source src="HCINWSPPräs.mp4" type="video/mp4"></video>
  </section>
  <section class="page page-7"><iframe data-src="spielerfotos.html" title="Spielerfotos"></iframe></section>

  <!-- Seite 8 – Glasrahmen mit wechselnden Tabellen, Start immer U13 -->
  <section class="page frame-page page-8">
    <div class="frame-container">
      <div class="frame" id="table-frame">
        <!-- Tabellen werden dynamisch per JS geladen -->
      </div>
    </div>
  </section>

  <section class="page page-9"></section>

  <footer class="signature">MS</footer>

  <!-- =========================
       JS – Rotation & Lade-Logik
       ============================ -->
  <script>
    window.addEventListener('DOMContentLoaded', async () => {
      const pages = document.querySelectorAll('.page');
      let current = 0;
      let settings;

      try {
        const res = await fetch('https://raw.githubusercontent.com/officehcijuniors-arch/HC-TIWAG-Innsbruck-Juniors/main/settings.json', {cache:"no-store"});
        settings = await res.json();
      } catch(err) {
        console.warn("⚠️ Einstellungen nicht geladen, Standardwerte werden genutzt.");
        settings = {
          pages: {
            1: { enabled: true,  duration: 10 },
            2: { enabled: true,  duration: 20 },
            3: { enabled: true,  duration: 15 },
            4: { enabled: true,  duration: 23 },
            5: { enabled: true,  duration: 20 },
            6: { enabled: true,  duration: 40 },
            7: { enabled: true,  duration: 55 },
            8: { enabled: true,  duration: 30 },
            9: { enabled: false, duration: 8 }
          },
          reload: 120
        };
      }

      function getActivePages() {
        const arr = [];
        for (let i=1;i<=pages.length;i++)
          if(settings.pages[i] && settings.pages[i].enabled) arr.push(i-1);
        return arr;
      }

      function getDurations() {
        const d = {};
        for (let i=1;i<=pages.length;i++)
          if(settings.pages[i]) d[i-1] = settings.pages[i].duration*1000;
        return d;
      }

      function loadIframe(page) {
        const iframe = page.querySelector('iframe');
        if(!iframe) return;
        if(!iframe.src && iframe.dataset.src) iframe.src = iframe.dataset.src;
      }

      function loadVideo(page){
        const video = page.querySelector('video');
        if(!video) return;
        video.load();
        video.currentTime = 0;
        video.play().catch(()=>{});
      }

      function showPage(index){
        pages.forEach((p,i)=>p.classList.toggle('active',i===index));
        const page = pages[index];
        if(page.classList.contains('video-page')) loadVideo(page);
        else if(page.querySelector('iframe')) loadIframe(page);
      }

      function rotateToNext(){
        const active = getActivePages();
        const durations = getDurations();
        if(active.length===0) return;
        let pos = active.indexOf(current);
        if(pos===-1) pos=0;
        current = active[(pos+1)%active.length];
        showPage(current);
        setTimeout(rotateToNext,durations[current]||8000);
      }

      current = 0;
      showPage(current);
      rotateToNext();

      if(settings.reload && settings.reload>0)
        setInterval(()=>location.reload(), settings.reload*60*1000);

      // =========================
      // Seite 8 – Tabellenrotation (robust)
      // =========================
      const tableSequence = [
        ["Tabelle_U13.html"],
        ["Tabelle_U15.html"],
        ["Tabelle_U17.html","Tabelle_U20.html"]
      ];

      let index = 0; // Start bei U13
      const frame = document.getElementById("table-frame");

      if(frame){

        function createIframe(src) {
          const iframe = document.createElement("iframe");
          iframe.src = src;
          iframe.title = src;
          iframe.width = "100%";
          iframe.height = "100%";
          iframe.style.border = "0";
          return iframe;
        }

        function rotateTables(){
          const currentTables = tableSequence[index];

          frame.classList.remove('multiple');
          frame.innerHTML = "";

          if(!currentTables || currentTables.length === 0){
            console.warn("⚠️ Keine Tabellen im aktuellen Index:", index);
            return;
          }

          if(currentTables.length === 1){
            const iframe = createIframe(currentTables[0]);
            frame.appendChild(iframe);
          } else {
            frame.classList.add('multiple');
            currentTables.forEach(tbl => {
              const iframe = createIframe(tbl);
              iframe.style.height = "50%";
              frame.appendChild(iframe);
            });
          }

          index = (index + 1) % tableSequence.length;
        }

        rotateTables();
        setInterval(rotateTables, 10000); // alle 10 Sekunden wechseln
      }

    });
  </script>
</body>
</html>
