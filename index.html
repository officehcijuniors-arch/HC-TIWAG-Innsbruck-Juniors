<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <title>HC TIWAG Innsbruck Juniors - Infosäule (Bereinigt)</title>

  <!-- ============================
       CSS – Schrift, Layout, Farben
       ============================ -->
  <style>
    @font-face {
      font-family: "Areno Serif";
      src: url("fonts/areno-serif-webfont.woff2") format("woff2"),
           url("fonts/areno-serif-webfont.woff") format("woff"),
           url("fonts/Areno-Serif.otf") format("opentype");
      font-weight: normal;
      font-style: normal;
      font-display: swap;
    }
    @font-face {
      font-family: "Areno Serif";
      src: url("fonts/areno-serif-webfont.woff2") format("woff2"),
           url("fonts/areno-serif-webfont.woff") format("woff"),
           url("fonts/Areno-Serif.otf") format("opentype");
      font-weight: 800;
      font-style: normal;
      font-display: swap;
    }

    html, body {
      margin: 0;
      height: 100%;
      background: #000;
      color: #fff;
      font-family: "Areno Serif", serif;
      overflow: hidden;
    }

    .page {
      position: absolute;
      inset: 0;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.8s ease;
    }
    .page.active {
      opacity: 1;
      pointer-events: all;
      z-index: 1;
    }

    iframe, video {
      width: 100%;
      height: 100%;
      border: 0;
      border-radius: 10px;
      display: block;
    }
    .video-page video {
      object-fit: contain;
    }

    .signature {
      position: fixed;
      bottom: 8px;
      right: 12px;
      font-size: 0.9em;
      color: rgba(255,255,255,0.4);
      pointer-events: none;
      z-index: 9999;
    }
  </style>
</head>
<body>

  <!-- =========================
       Seitenstruktur
       ========================= -->
  <section class="page page-1 active"><iframe data-src="Infopoint.html" title="Infosäule"></iframe></section>
  <section class="page page-2"><iframe data-src="KALENDER.html" title="Kalender"></iframe></section>
  <section class="page page-3"><iframe data-src="ORG.html" title="Organigramm"></iframe></section>
  <section class="page video-page page-4">
    <video autoplay loop muted playsinline preload="auto"><source src="Fotoshop.mp4" type="video/mp4"></video>
  </section>
  <section class="page video-page page-5">
    <video autoplay loop muted playsinline preload="auto"><source src="Fanshop.mp4" type="video/mp4"></video>
  </section>
  <section class="page video-page page-6">
    <video autoplay loop muted playsinline preload="auto"><source src="HCINWSPPräs.mp4" type="video/mp4"></video>
  </section>
  <section class="page page-7"><iframe data-src="spielerfotos.html" title="Spielerfotos"></iframe></section>
  <section class="page page-8"></section>
  <section class="page page-9"></section>

  <footer class="signature">MS</footer>

  <!-- =========================
       JS – Rotation & Lade-Logik
       ========================= -->
  <script>
    window.addEventListener('DOMContentLoaded', async () => {
      const pages = document.querySelectorAll('.page');
      let current = 0;
      let settings;

      try {
        const res = await fetch('https://raw.githubusercontent.com/officehcijuniors-arch/HC-TIWAG-Innsbruck-Juniors/main/settings.json', {cache:"no-store"});
        settings = await res.json();
      } catch(err) {
        console.warn("⚠️ Einstellungen nicht geladen, Standardwerte werden genutzt.");
        settings = {
          pages: {
            1: { enabled: true,  duration: 10 },
            2: { enabled: true,  duration: 20 },
            3: { enabled: true,  duration: 15 },
            4: { enabled: true,  duration: 23 },
            5: { enabled: true,  duration: 20 },
            6: { enabled: true,  duration: 40 },
            7: { enabled: true,  duration: 55 },
            8: { enabled: false, duration: 8 },
            9: { enabled: false, duration: 8 }
          },
          reload: 120
        };
      }

      function getActivePages() {
        const arr = [];
        for (let i=1;i<=pages.length;i++)
          if(settings.pages[i] && settings.pages[i].enabled) arr.push(i-1);
        return arr;
      }

      function getDurations() {
        const d = {};
        for (let i=1;i<=pages.length;i++)
          if(settings.pages[i]) d[i-1] = settings.pages[i].duration*1000;
        return d;
      }

      function loadIframe(page) {
        const iframe = page.querySelector('iframe');
        if(!iframe) return;
        if(!iframe.src && iframe.dataset.src) iframe.src = iframe.dataset.src;
      }

      function loadVideo(page){
        const video = page.querySelector('video');
        if(!video) return;
        video.load();
        video.currentTime = 0;
        video.play().catch(()=>{});
      }

      function showPage(index){
        pages.forEach((p,i)=>p.classList.toggle('active',i===index));
        const page = pages[index];
        if(page.classList.contains('video-page')) loadVideo(page);
        else loadIframe(page);
      }

      function rotateToNext(){
        const active = getActivePages();
        const durations = getDurations();
        if(active.length===0) return;
        let pos = active.indexOf(current);
        if(pos===-1) pos=0;
        current = active[(pos+1)%active.length];
        showPage(current);
        setTimeout(rotateToNext,durations[current]||8000);
      }

      current = 0;
      showPage(current);
      rotateToNext();

      if(settings.reload && settings.reload>0)
        setInterval(()=>location.reload(), settings.reload*60*1000);
    });
  </script>
</body>
</html>
